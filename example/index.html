<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="../exe-version.js"></script>
  <title>读取Exe,Dll版本</title>
</head>

<body>

  <input type="file" id='file' multiple /><br />
  <ul id='output'></ul>
</body>
<script>
  document.getElementById("file").addEventListener("change", handleFileSelecter, false);

  function handleFileSelecter(e) {
    var files = e.target.files;
    var oFReader = new FileReader();

    oFReader.onloadend = function (e) {
      let version = getExeVersion(e.target.result)
      let content = `<span>版本号: ${version}</span>`
      document.getElementById("output").innerHTML = content;
    }

    oFReader.readAsArrayBuffer(files[0]);

  }
</script>

</html>